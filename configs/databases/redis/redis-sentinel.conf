# Redis Sentinel Configuration for BMAD Studio Template
# High Availability Monitoring and Failover

################################ SENTINEL CORE ################################

port 26379
bind 0.0.0.0

# Sentinel announce settings for Docker/NAT environments
# sentinel announce-ip 10.0.1.100
# sentinel announce-port 26379

################################ SECURITY ####################################

requirepass ${REDIS_SENTINEL_PASSWORD}
sentinel auth-pass bmad-redis-master ${REDIS_PASSWORD}
sentinel auth-user bmad-redis-master sentinel

################################ MONITORING ##################################

# Monitor Redis master
sentinel monitor bmad-redis-master 127.0.0.1 6379 2
sentinel down-after-milliseconds bmad-redis-master 30000
sentinel parallel-syncs bmad-redis-master 1
sentinel failover-timeout bmad-redis-master 180000

# Notification scripts
sentinel notification-script bmad-redis-master /etc/redis/notify.sh
sentinel client-reconfig-script bmad-redis-master /etc/redis/reconfig.sh

################################# LOGGING ####################################

logfile /var/log/redis/sentinel.log
loglevel notice
syslog-enabled no

################################# GENERAL ####################################

dir /var/lib/redis
sentinel deny-scripts-reconfig yes

################################ ADVANCED ####################################

# Sentinel resolve hostnames
sentinel resolve-hostnames no
sentinel announce-hostnames no

# Connection limits
sentinel tcp-keepalive 60

# Performance tuning
hz 10